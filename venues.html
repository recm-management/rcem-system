<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RCEM ‚Äì Venues</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f4f6f9;
}

/* HEADER */
.header{
  background:linear-gradient(135deg,#0d47a1,#1976d2);
  color:#fff;
  padding:15px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.header h2{margin:0;font-size:18px}
.logout{
  background:#e53935;
  border:none;
  color:#fff;
  padding:8px 14px;
  border-radius:20px;
  cursor:pointer;
}

/* CONTAINER */
.container{padding:15px}

/* BUTTONS */
.btn{
  padding:10px 16px;
  border:none;
  border-radius:25px;
  font-size:14px;
  cursor:pointer;
}
.add{
  background:linear-gradient(135deg,#2e7d32,#43a047);
  color:#fff;
}
.toggle{
  background:linear-gradient(135deg,#f9a825,#fbc02d);
  color:#000;
  margin-top:10px;
}

/* SEARCH */
.search{
  width:100%;
  padding:12px 40px;
  border-radius:25px;
  border:1px solid #ccc;
  margin:15px 0;
  font-size:14px;
  box-sizing:border-box;
}
.search-icon{
  position:relative;
}
.search-icon span{
  position:absolute;
  left:14px;
  top:50%;
  transform:translateY(-50%);
  color:#777;
}

/* CARD */
.card{
  background:#fff;
  padding:15px;
  border-radius:15px;
  margin-bottom:15px;
  box-shadow:0 4px 12px rgba(0,0,0,.12);
}
.card h3{
  margin:0 0 6px;
  font-size:17px;
}

/* STATUS */
.status{
  display:flex;
  align-items:center;
  gap:8px;
  font-weight:bold;
}
.dot{
  width:12px;
  height:12px;
  border-radius:50%;
}
.active{background:#2e7d32}
.inactive{background:#d32f2f}

/* INFO */
.info{
  margin-top:8px;
  font-size:14px;
  display:flex;
  align-items:center;
  gap:8px;
}
.info a{
  color:#1976d2;
  text-decoration:none;
  word-break:break-word;
}

/* MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  display:none;
  align-items:center;
  justify-content:center;
}
.modal-box{
  background:#fff;
  padding:20px;
  border-radius:15px;
  width:90%;
  max-width:420px;
}
.modal-box input{
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border-radius:10px;
  border:1px solid #ccc;
  box-sizing:border-box;
}
.modal-actions{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.cancel{
  text-align:center;
  color:#777;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="header">
  <h2>RCEM ‚Äì Venues</h2>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<div class="container">

  <button class="btn add" onclick="openModal()">+ Add Venue</button>

  <div class="search-icon">
    <span>üîç</span>
    <input class="search" id="search" placeholder="Search venue, mobile or address" oninput="render()">
  </div>

  <div id="venueList">Loading...</div>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-box">
    <h3>Add Venue</h3>
    <input id="vname" placeholder="Venue Name">
    <input id="vcontact" placeholder="Mobile Number">
    <input id="vlocation" placeholder="Address (Google Maps friendly)">
    <div class="modal-actions">
      <button class="btn add" onclick="saveVenue()">Save</button>
      <div class="cancel" onclick="closeModal()">Cancel</div>
    </div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig={
  apiKey:"AIzaSyDK3dqXZuWaH3gctxURdOZc_Q1UfioesaA",
  authDomain:"rcem-system.firebaseapp.com",
  projectId:"rcem-system"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.firestore();

let venues=[];

auth.onAuthStateChanged(u=>{
  if(!u) location.href="index.html";
});

function logout(){
  auth.signOut().then(()=>location.href="index.html");
}

function openModal(){
  modal.style.display="flex";
  vname.value="";
  vcontact.value="";
  vlocation.value="";
}
function closeModal(){
  modal.style.display="none";
}

function saveVenue(){
  if(!vname.value.trim()) return alert("Venue name required");
  db.collection("venues").add({
    venue_name:vname.value,
    contact:vcontact.value,
    location:vlocation.value,
    active:true
  });
  closeModal();
}

function toggle(id,val){
  db.collection("venues").doc(id).update({active:!val});
}

function render(){
  const q=search.value.toLowerCase();
  venueList.innerHTML="";
  venues
    .filter(v=>`${v.venue_name} ${v.contact} ${v.location}`.toLowerCase().includes(q))
    .forEach(v=>{
      const mapLink=`https://www.google.com/maps/search/?query=${encodeURIComponent(v.location)}`;
      venueList.innerHTML+=`
        <div class="card">
          <h3>${v.venue_name}</h3>
          <div class="status">
            <div class="dot ${v.active?"active":"inactive"}"></div>
            ${v.active?"Active":"Inactive"}
          </div>
          <div class="info">üìû ${v.contact||"-"}</div>
          <div class="info">
            üìç <a href="${mapLink}" target="_blank">${v.location||"-"}</a>
          </div>
          <button class="btn toggle" onclick='toggle("${v.id}",${v.active})'>Toggle</button>
        </div>
      `;
    });
}

db.collection("venues").onSnapshot(s=>{
  venues=[];
  s.forEach(d=>venues.push({id:d.id,...d.data()}));
  render();
});
</script>

</body>
</html>
